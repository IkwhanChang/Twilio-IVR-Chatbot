{"ast":null,"code":"import _toConsumableArray from\"/Users/matthewchang/workspace/github/SEM2020/store-owner-console/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/matthewchang/workspace/github/SEM2020/store-owner-console/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/Users/matthewchang/workspace/github/SEM2020/store-owner-console/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/matthewchang/workspace/github/SEM2020/store-owner-console/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/matthewchang/workspace/github/SEM2020/store-owner-console/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/matthewchang/workspace/github/SEM2020/store-owner-console/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React from\"react\";import firebase from\"../../firebase\";import{connect}from\"react-redux\";import{setCurrentChannel,setPrivateChannel}from\"../../actions\";import{Menu,Icon}from\"semantic-ui-react\";var Starred=/*#__PURE__*/function(_React$Component){_inherits(Starred,_React$Component);var _super=_createSuper(Starred);function Starred(){var _this;_classCallCheck(this,Starred);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={user:_this.props.currentUser,usersRef:firebase.database().ref(\"users\"),activeChannel:\"\",starredChannels:[]};_this.removeListener=function(){_this.state.usersRef.child(\"\".concat(_this.state.user.uid,\"/starred\")).off();};_this.addListeners=function(userId){_this.state.usersRef.child(userId).child(\"starred\").on(\"child_added\",function(snap){var starredChannel=_objectSpread({id:snap.key},snap.val());_this.setState({starredChannels:[].concat(_toConsumableArray(_this.state.starredChannels),[starredChannel])});});_this.state.usersRef.child(userId).child(\"starred\").on(\"child_removed\",function(snap){var channelToRemove=_objectSpread({id:snap.key},snap.val());var filteredChannels=_this.state.starredChannels.filter(function(channel){return channel.id!==channelToRemove.id;});_this.setState({starredChannels:filteredChannels});});};_this.setActiveChannel=function(channel){_this.setState({activeChannel:channel.id});};_this.changeChannel=function(channel){_this.setActiveChannel(channel);_this.props.setCurrentChannel(channel);_this.props.setPrivateChannel(false);};_this.displayChannels=function(starredChannels){return starredChannels.length>0&&starredChannels.map(function(channel){return/*#__PURE__*/_jsxs(Menu.Item,{onClick:function onClick(){return _this.changeChannel(channel);},name:channel.name,style:{opacity:0.7},active:channel.id===_this.state.activeChannel,children:[\"# \",channel.name]},channel.id);});};return _this;}_createClass(Starred,[{key:\"componentDidMount\",value:function componentDidMount(){if(this.state.user){this.addListeners(this.state.user.uid);}}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.removeListener();}},{key:\"render\",value:function render(){var starredChannels=this.state.starredChannels;return/*#__PURE__*/_jsxs(Menu.Menu,{className:\"menu\",children:[/*#__PURE__*/_jsxs(Menu.Item,{children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(Icon,{name:\"star\"}),\" STARRED\"]}),\" \",\"(\",starredChannels.length,\")\"]}),this.displayChannels(starredChannels)]});}}]);return Starred;}(React.Component);export default connect(null,{setCurrentChannel:setCurrentChannel,setPrivateChannel:setPrivateChannel})(Starred);","map":{"version":3,"sources":["/Users/matthewchang/workspace/github/SEM2020/store-owner-console/src/components/SidePanel/Starred.js"],"names":["React","firebase","connect","setCurrentChannel","setPrivateChannel","Menu","Icon","Starred","state","user","props","currentUser","usersRef","database","ref","activeChannel","starredChannels","removeListener","child","uid","off","addListeners","userId","on","snap","starredChannel","id","key","val","setState","channelToRemove","filteredChannels","filter","channel","setActiveChannel","changeChannel","displayChannels","length","map","name","opacity","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport firebase from \"../../firebase\";\nimport { connect } from \"react-redux\";\nimport { setCurrentChannel, setPrivateChannel } from \"../../actions\";\nimport { Menu, Icon } from \"semantic-ui-react\";\n\nclass Starred extends React.Component {\n  state = {\n    user: this.props.currentUser,\n    usersRef: firebase.database().ref(\"users\"),\n    activeChannel: \"\",\n    starredChannels: []\n  };\n\n  componentDidMount() {\n    if (this.state.user) {\n      this.addListeners(this.state.user.uid);\n    }\n  }\n\n  componentWillUnmount() {\n    this.removeListener();\n  }\n\n  removeListener = () => {\n    this.state.usersRef.child(`${this.state.user.uid}/starred`).off();\n  };\n\n  addListeners = userId => {\n    this.state.usersRef\n      .child(userId)\n      .child(\"starred\")\n      .on(\"child_added\", snap => {\n        const starredChannel = { id: snap.key, ...snap.val() };\n        this.setState({\n          starredChannels: [...this.state.starredChannels, starredChannel]\n        });\n      });\n\n    this.state.usersRef\n      .child(userId)\n      .child(\"starred\")\n      .on(\"child_removed\", snap => {\n        const channelToRemove = { id: snap.key, ...snap.val() };\n        const filteredChannels = this.state.starredChannels.filter(channel => {\n          return channel.id !== channelToRemove.id;\n        });\n        this.setState({ starredChannels: filteredChannels });\n      });\n  };\n\n  setActiveChannel = channel => {\n    this.setState({ activeChannel: channel.id });\n  };\n\n  changeChannel = channel => {\n    this.setActiveChannel(channel);\n    this.props.setCurrentChannel(channel);\n    this.props.setPrivateChannel(false);\n  };\n\n  displayChannels = starredChannels =>\n    starredChannels.length > 0 &&\n    starredChannels.map(channel => (\n      <Menu.Item\n        key={channel.id}\n        onClick={() => this.changeChannel(channel)}\n        name={channel.name}\n        style={{ opacity: 0.7 }}\n        active={channel.id === this.state.activeChannel}\n      >\n        # {channel.name}\n      </Menu.Item>\n    ));\n\n  render() {\n    const { starredChannels } = this.state;\n\n    return (\n      <Menu.Menu className=\"menu\">\n        <Menu.Item>\n          <span>\n            <Icon name=\"star\" /> STARRED\n          </span>{\" \"}\n          ({starredChannels.length})\n        </Menu.Item>\n        {this.displayChannels(starredChannels)}\n      </Menu.Menu>\n    );\n  }\n}\n\nexport default connect(\n  null,\n  { setCurrentChannel, setPrivateChannel }\n)(Starred);\n"]},"metadata":{},"sourceType":"module"}