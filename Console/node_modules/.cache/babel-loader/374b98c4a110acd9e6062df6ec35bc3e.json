{"ast":null,"code":"import _defineProperty from\"/Users/matthewchang/workspace/github/SEM2020/store-owner-console/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/matthewchang/workspace/github/SEM2020/store-owner-console/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/matthewchang/workspace/github/SEM2020/store-owner-console/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/matthewchang/workspace/github/SEM2020/store-owner-console/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/matthewchang/workspace/github/SEM2020/store-owner-console/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import React from\"react\";import firebase from\"../../firebase\";import md5 from\"md5\";import{Grid,Form,Segment,Button,Header,Message,Icon}from\"semantic-ui-react\";import{Link}from\"react-router-dom\";var Register=/*#__PURE__*/function(_React$Component){_inherits(Register,_React$Component);var _super=_createSuper(Register);function Register(){var _this;_classCallCheck(this,Register);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={username:\"\",storeName:\"\",openHour:\"\",closeHour:\"\",address1:\"\",address2:\"\",zipcode:\"\",city:\"\",state:\"\",email:\"\",password:\"\",passwordConfirmation:\"\",errors:[],loading:false,usersRef:firebase.database().ref(\"users\")};_this.isFormValid=function(){var errors=[];var error;if(_this.isFormEmpty(_this.state)){error={message:\"Fill in all fields\"};_this.setState({errors:errors.concat(error)});return false;}else if(!_this.isPasswordValid(_this.state)){error={message:\"Password is invalid\"};_this.setState({errors:errors.concat(error)});return false;}else{return true;}};_this.isFormEmpty=function(_ref){var username=_ref.username,storeName=_ref.storeName,email=_ref.email,password=_ref.password,passwordConfirmation=_ref.passwordConfirmation;return!username.length||!storeName.length||!email.length||!password.length||!passwordConfirmation.length;};_this.isPasswordValid=function(_ref2){var password=_ref2.password,passwordConfirmation=_ref2.passwordConfirmation;if(password.length<6||passwordConfirmation.length<6){return false;}else if(password!==passwordConfirmation){return false;}else{return true;}};_this.displayErrors=function(errors){return errors.map(function(error,i){return/*#__PURE__*/_jsx(\"p\",{children:error.message},i);});};_this.handleChange=function(event){_this.setState(_defineProperty({},event.target.name,event.target.value));};_this.handleSubmit=function(event){event.preventDefault();if(_this.isFormValid()){_this.setState({errors:[],loading:true});var _this$state=_this.state,storeName=_this$state.storeName,openHour=_this$state.openHour,closeHour=_this$state.closeHour,address1=_this$state.address1,address2=_this$state.address2,zipcode=_this$state.zipcode,city=_this$state.city,state=_this$state.state;firebase.auth().createUserWithEmailAndPassword(_this.state.email,_this.state.password).then(function(createdUser){console.log(createdUser);createdUser.user.updateProfile({displayName:_this.state.username,photoURL:\"http://gravatar.com/avatar/\".concat(md5(createdUser.user.email),\"?d=identicon\")}).then(function(){_this.saveUser({createdUser:createdUser,storeName:storeName,openHour:openHour,closeHour:closeHour,address1:address1,address2:address2,zipcode:zipcode,city:city,state:state}).then(function(){console.log(\"user saved\");});}).catch(function(err){console.error(err);_this.setState({errors:_this.state.errors.concat(err),loading:false});});}).catch(function(err){console.error(err);_this.setState({errors:_this.state.errors.concat(err),loading:false});});}};_this.saveUser=function(_ref3){var createdUser=_ref3.createdUser,storeName=_ref3.storeName,openHour=_ref3.openHour,closeHour=_ref3.closeHour,address1=_ref3.address1,address2=_ref3.address2,zipcode=_ref3.zipcode,city=_ref3.city,state=_ref3.state;return _this.state.usersRef.child(createdUser.user.uid).set({name:createdUser.user.displayName,avatar:createdUser.user.photoURL,storeName:storeName,openHour:openHour,closeHour:closeHour,address1:address1,address2:address2,zipcode:zipcode,city:city,state:state});};_this.handleInputError=function(errors,inputName){return errors.some(function(error){return error.message.toLowerCase().includes(inputName);})?\"error\":\"\";};return _this;}_createClass(Register,[{key:\"render\",value:function render(){var _this$state2=this.state,username=_this$state2.username,storeName=_this$state2.storeName,openHour=_this$state2.openHour,closeHour=_this$state2.closeHour,address1=_this$state2.address1,address2=_this$state2.address2,zipcode=_this$state2.zipcode,city=_this$state2.city,state=_this$state2.state,email=_this$state2.email,password=_this$state2.password,passwordConfirmation=_this$state2.passwordConfirmation,errors=_this$state2.errors,loading=_this$state2.loading;return/*#__PURE__*/_jsx(Grid,{textAlign:\"center\",verticalAlign:\"middle\",className:\"app\",children:/*#__PURE__*/_jsxs(Grid.Column,{style:{maxWidth:450},children:[/*#__PURE__*/_jsxs(Header,{as:\"h1\",icon:true,color:\"orange\",textAlign:\"center\",children:[/*#__PURE__*/_jsx(Icon,{name:\"add user\",color:\"orange\"}),\"Register for IVRobot\"]}),/*#__PURE__*/_jsx(Form,{onSubmit:this.handleSubmit,size:\"large\",children:/*#__PURE__*/_jsxs(Segment,{stacked:true,children:[/*#__PURE__*/_jsx(Form.Input,{fluid:true,name:\"username\",icon:\"user\",iconPosition:\"left\",placeholder:\"Username\",onChange:this.handleChange,value:username,type:\"text\"}),/*#__PURE__*/_jsx(Form.Input,{fluid:true,name:\"storeName\",icon:\"warehouse\",iconPosition:\"left\",placeholder:\"Store Name\",onChange:this.handleChange,value:storeName,type:\"text\"}),/*#__PURE__*/_jsx(Form.Input,{fluid:true,name:\"email\",icon:\"mail\",iconPosition:\"left\",placeholder:\"Email Address\",onChange:this.handleChange,value:email,className:this.handleInputError(errors,\"email\"),type:\"email\"}),/*#__PURE__*/_jsx(Form.Input,{fluid:true,name:\"password\",icon:\"lock\",iconPosition:\"left\",placeholder:\"Password\",onChange:this.handleChange,value:password,className:this.handleInputError(errors,\"password\"),type:\"password\"}),/*#__PURE__*/_jsx(Form.Input,{fluid:true,name:\"passwordConfirmation\",icon:\"repeat\",iconPosition:\"left\",placeholder:\"Password Confirmation\",onChange:this.handleChange,value:passwordConfirmation,className:this.handleInputError(errors,\"password\"),type:\"password\"}),/*#__PURE__*/_jsx(Form.Input,{fluid:true,name:\"openHour\",icon:\"clock outline\",iconPosition:\"left\",placeholder:\"Open Hour\",onChange:this.handleChange,value:openHour,type:\"text\"}),/*#__PURE__*/_jsx(Form.Input,{fluid:true,name:\"closeHour\",icon:\"clock outline\",iconPosition:\"left\",placeholder:\"Close Hour\",onChange:this.handleChange,value:closeHour,type:\"text\"}),/*#__PURE__*/_jsx(Form.Input,{fluid:true,name:\"address1\",icon:\"address book outline\",iconPosition:\"left\",placeholder:\"Address1\",onChange:this.handleChange,value:address1,type:\"text\"}),/*#__PURE__*/_jsx(Form.Input,{fluid:true,name:\"address2\",icon:\"address book outline\",iconPosition:\"left\",placeholder:\"Address2\",onChange:this.handleChange,value:address2,type:\"text\"}),/*#__PURE__*/_jsx(Form.Input,{fluid:true,name:\"city\",placeholder:\"City\",onChange:this.handleChange,value:city,type:\"text\"}),/*#__PURE__*/_jsx(Form.Input,{fluid:true,name:\"state\",placeholder:\"State\",onChange:this.handleChange,value:state,type:\"text\"}),/*#__PURE__*/_jsx(Form.Input,{fluid:true,name:\"zipcode\",placeholder:\"Zip Code\",onChange:this.handleChange,value:zipcode,type:\"text\"}),/*#__PURE__*/_jsx(Button,{disabled:loading,className:loading?\"loading\":\"\",color:\"orange\",fluid:true,size:\"large\",children:\"Submit\"})]})}),errors.length>0&&/*#__PURE__*/_jsxs(Message,{error:true,children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Error\"}),this.displayErrors(errors)]}),/*#__PURE__*/_jsxs(Message,{children:[\"Already a user? \",/*#__PURE__*/_jsx(Link,{to:\"/login\",children:\"Login\"})]})]})});}}]);return Register;}(React.Component);export default Register;","map":{"version":3,"sources":["/Users/matthewchang/workspace/github/SEM2020/store-owner-console/src/components/Auth/Register.js"],"names":["React","firebase","md5","Grid","Form","Segment","Button","Header","Message","Icon","Link","Register","state","username","storeName","openHour","closeHour","address1","address2","zipcode","city","email","password","passwordConfirmation","errors","loading","usersRef","database","ref","isFormValid","error","isFormEmpty","message","setState","concat","isPasswordValid","length","displayErrors","map","i","handleChange","event","target","name","value","handleSubmit","preventDefault","auth","createUserWithEmailAndPassword","then","createdUser","console","log","user","updateProfile","displayName","photoURL","saveUser","catch","err","child","uid","set","avatar","handleInputError","inputName","some","toLowerCase","includes","maxWidth","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport firebase from \"../../firebase\";\nimport md5 from \"md5\";\nimport {\n  Grid,\n  Form,\n  Segment,\n  Button,\n  Header,\n  Message,\n  Icon\n} from \"semantic-ui-react\";\nimport { Link } from \"react-router-dom\";\n\nclass Register extends React.Component {\n  state = {\n    username: \"\",\n    storeName: \"\",\n    openHour: \"\",\n    closeHour: \"\",\n    address1: \"\",\n    address2: \"\",\n    zipcode: \"\",\n    city: \"\",\n    state: \"\",\n    email: \"\",\n    password: \"\",\n    passwordConfirmation: \"\",\n    errors: [],\n    loading: false,\n    usersRef: firebase.database().ref(\"users\")\n  };\n\n  isFormValid = () => {\n    let errors = [];\n    let error;\n\n    if (this.isFormEmpty(this.state)) {\n      error = { message: \"Fill in all fields\" };\n      this.setState({ errors: errors.concat(error) });\n      return false;\n    } else if (!this.isPasswordValid(this.state)) {\n      error = { message: \"Password is invalid\" };\n      this.setState({ errors: errors.concat(error) });\n      return false;\n    } else {\n      return true;\n    }\n  };\n\n  isFormEmpty = ({ username, storeName, email, password, passwordConfirmation }) => {\n    return (\n      !username.length ||\n      !storeName.length ||\n      !email.length ||\n      !password.length ||\n      !passwordConfirmation.length\n    );\n  };\n\n  isPasswordValid = ({ password, passwordConfirmation }) => {\n    if (password.length < 6 || passwordConfirmation.length < 6) {\n      return false;\n    } else if (password !== passwordConfirmation) {\n      return false;\n    } else {\n      return true;\n    }\n  };\n\n  displayErrors = errors =>\n    errors.map((error, i) => <p key={i}>{error.message}</p>);\n\n  handleChange = event => {\n    this.setState({ [event.target.name]: event.target.value });\n  };\n\n  handleSubmit = event => {\n    event.preventDefault();\n    if (this.isFormValid()) {\n      this.setState({ errors: [], loading: true });\n\n      const {\n        storeName,\n        openHour,\n        closeHour,\n        address1,\n        address2,\n        zipcode,\n        city,\n        state,\n      } = this.state;\n\n      firebase\n        .auth()\n        .createUserWithEmailAndPassword(this.state.email, this.state.password)\n        .then(createdUser => {\n          console.log(createdUser);\n          createdUser.user\n            .updateProfile({\n              displayName: this.state.username,\n              photoURL: `http://gravatar.com/avatar/${md5(\n                createdUser.user.email\n              )}?d=identicon`\n            })\n            .then(() => {\n              this.saveUser({\n                createdUser, \n                storeName,\n                openHour,\n                closeHour,\n                address1,\n                address2,\n                zipcode,\n                city,\n                state,\n              }).then(() => {\n                console.log(\"user saved\");\n              });\n            })\n            .catch(err => {\n              console.error(err);\n              this.setState({\n                errors: this.state.errors.concat(err),\n                loading: false\n              });\n            });\n        })\n        .catch(err => {\n          console.error(err);\n          this.setState({\n            errors: this.state.errors.concat(err),\n            loading: false\n          });\n        });\n    }\n  };\n\n  saveUser = ({createdUser, \n    storeName,\n    openHour,\n    closeHour,\n    address1,\n    address2,\n    zipcode,\n    city,\n    state,\n  }) => {\n    return this.state.usersRef.child(createdUser.user.uid).set({\n      name: createdUser.user.displayName,\n      avatar: createdUser.user.photoURL,\n      storeName,\n      openHour,\n      closeHour,\n      address1,\n      address2,\n      zipcode,\n      city,\n      state,\n\n    });\n  };\n\n  handleInputError = (errors, inputName) => {\n    return errors.some(error => error.message.toLowerCase().includes(inputName))\n      ? \"error\"\n      : \"\";\n  };\n\n  render() {\n    const {\n      username,\n      storeName,\n      openHour,\n      closeHour,\n      address1,\n      address2,\n      zipcode,\n      city,\n      state,\n      email,\n      password,\n      passwordConfirmation,\n      errors,\n      loading\n    } = this.state;\n\n    return (\n      <Grid textAlign=\"center\" verticalAlign=\"middle\" className=\"app\">\n        <Grid.Column style={{ maxWidth: 450 }}>\n          <Header as=\"h1\" icon color=\"orange\" textAlign=\"center\">\n            <Icon name=\"add user\" color=\"orange\" />\n            Register for IVRobot\n          </Header>\n          <Form onSubmit={this.handleSubmit} size=\"large\">\n            <Segment stacked>\n              <Form.Input\n                fluid\n                name=\"username\"\n                icon=\"user\"\n                iconPosition=\"left\"\n                placeholder=\"Username\"\n                onChange={this.handleChange}\n                value={username}\n                type=\"text\"\n              />\n\n<Form.Input\n                fluid\n                name=\"storeName\"\n                icon=\"warehouse\"\n                iconPosition=\"left\"\n                placeholder=\"Store Name\"\n                onChange={this.handleChange}\n                value={storeName}\n                type=\"text\"\n              />\n\n              <Form.Input\n                fluid\n                name=\"email\"\n                icon=\"mail\"\n                iconPosition=\"left\"\n                placeholder=\"Email Address\"\n                onChange={this.handleChange}\n                value={email}\n                className={this.handleInputError(errors, \"email\")}\n                type=\"email\"\n              />\n\n              <Form.Input\n                fluid\n                name=\"password\"\n                icon=\"lock\"\n                iconPosition=\"left\"\n                placeholder=\"Password\"\n                onChange={this.handleChange}\n                value={password}\n                className={this.handleInputError(errors, \"password\")}\n                type=\"password\"\n              />\n\n              <Form.Input\n                fluid\n                name=\"passwordConfirmation\"\n                icon=\"repeat\"\n                iconPosition=\"left\"\n                placeholder=\"Password Confirmation\"\n                onChange={this.handleChange}\n                value={passwordConfirmation}\n                className={this.handleInputError(errors, \"password\")}\n                type=\"password\"\n              />\n\n\n<Form.Input\n                fluid\n                name=\"openHour\"\n                icon=\"clock outline\"\n                iconPosition=\"left\"\n                placeholder=\"Open Hour\"\n                onChange={this.handleChange}\n                value={openHour}\n                type=\"text\"\n              />\n\n<Form.Input\n                fluid\n                name=\"closeHour\"\n                icon=\"clock outline\"\n                iconPosition=\"left\"\n                placeholder=\"Close Hour\"\n                onChange={this.handleChange}\n                value={closeHour}\n                type=\"text\"\n              />\n\n<Form.Input\n                fluid\n                name=\"address1\"\n                icon=\"address book outline\"\n                iconPosition=\"left\"\n                placeholder=\"Address1\"\n                onChange={this.handleChange}\n                value={address1}\n                type=\"text\"\n              />\n\n<Form.Input\n                fluid\n                name=\"address2\"\n                icon=\"address book outline\"\n                iconPosition=\"left\"\n                placeholder=\"Address2\"\n                onChange={this.handleChange}\n                value={address2}\n                type=\"text\"\n              />\n\n<Form.Input\n                fluid\n                name=\"city\"\n\n                placeholder=\"City\"\n                onChange={this.handleChange}\n                value={city}\n                type=\"text\"\n              />\n\n<Form.Input\n                fluid\n                name=\"state\"\n                placeholder=\"State\"\n                onChange={this.handleChange}\n                value={state}\n                type=\"text\"\n              />\n\n<Form.Input\n                fluid\n                name=\"zipcode\"\n                placeholder=\"Zip Code\"\n                onChange={this.handleChange}\n                value={zipcode}\n                type=\"text\"\n              />\n\n              <Button\n                disabled={loading}\n                className={loading ? \"loading\" : \"\"}\n                color=\"orange\"\n                fluid\n                size=\"large\"\n              >\n                Submit\n              </Button>\n            </Segment>\n          </Form>\n          {errors.length > 0 && (\n            <Message error>\n              <h3>Error</h3>\n              {this.displayErrors(errors)}\n            </Message>\n          )}\n          <Message>\n            Already a user? <Link to=\"/login\">Login</Link>\n          </Message>\n        </Grid.Column>\n      </Grid>\n    );\n  }\n}\n\nexport default Register;\n"]},"metadata":{},"sourceType":"module"}