{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/matthewchang/workspace/github/SEM2020/store-owner-console/src/components/SidePanel/Starred.js\";\nimport React from \"react\";\nimport firebase from \"../../firebase\";\nimport { connect } from \"react-redux\";\nimport { setCurrentChannel, setPrivateChannel } from \"../../actions\";\nimport { Menu, Icon } from \"semantic-ui-react\";\n\nclass Starred extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      user: this.props.currentUser,\n      usersRef: firebase.database().ref(\"users\"),\n      activeChannel: \"\",\n      starredChannels: []\n    };\n\n    this.removeListener = () => {\n      this.state.usersRef.child(`${this.state.user.uid}/starred`).off();\n    };\n\n    this.addListeners = userId => {\n      this.state.usersRef.child(userId).child(\"starred\").on(\"child_added\", snap => {\n        const starredChannel = {\n          id: snap.key,\n          ...snap.val()\n        };\n        this.setState({\n          starredChannels: [...this.state.starredChannels, starredChannel]\n        });\n      });\n      this.state.usersRef.child(userId).child(\"starred\").on(\"child_removed\", snap => {\n        const channelToRemove = {\n          id: snap.key,\n          ...snap.val()\n        };\n        const filteredChannels = this.state.starredChannels.filter(channel => {\n          return channel.id !== channelToRemove.id;\n        });\n        this.setState({\n          starredChannels: filteredChannels\n        });\n      });\n    };\n\n    this.setActiveChannel = channel => {\n      this.setState({\n        activeChannel: channel.id\n      });\n    };\n\n    this.changeChannel = channel => {\n      this.setActiveChannel(channel);\n      this.props.setCurrentChannel(channel);\n      this.props.setPrivateChannel(false);\n    };\n\n    this.displayChannels = starredChannels => starredChannels.length > 0 && starredChannels.map(channel => /*#__PURE__*/_jsxDEV(Menu.Item, {\n      onClick: () => this.changeChannel(channel),\n      name: channel.name,\n      style: {\n        opacity: 0.7\n      },\n      active: channel.id === this.state.activeChannel,\n      children: [\"# \", channel.name]\n    }, channel.id, true, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this));\n  }\n\n  componentDidMount() {\n    if (this.state.user) {\n      this.addListeners(this.state.user.uid);\n    }\n  }\n\n  componentWillUnmount() {\n    this.removeListener();\n  }\n\n  render() {\n    const {\n      starredChannels\n    } = this.state;\n    return /*#__PURE__*/_jsxDEV(Menu.Menu, {\n      className: \"menu\",\n      children: [/*#__PURE__*/_jsxDEV(Menu.Item, {\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: [/*#__PURE__*/_jsxDEV(Icon, {\n            name: \"star\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 13\n          }, this), \" STARRED\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 11\n        }, this), \" \", \"(\", starredChannels.length, \")\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }, this), this.displayChannels(starredChannels)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default connect(null, {\n  setCurrentChannel,\n  setPrivateChannel\n})(Starred);","map":{"version":3,"sources":["/Users/matthewchang/workspace/github/SEM2020/store-owner-console/src/components/SidePanel/Starred.js"],"names":["React","firebase","connect","setCurrentChannel","setPrivateChannel","Menu","Icon","Starred","Component","state","user","props","currentUser","usersRef","database","ref","activeChannel","starredChannels","removeListener","child","uid","off","addListeners","userId","on","snap","starredChannel","id","key","val","setState","channelToRemove","filteredChannels","filter","channel","setActiveChannel","changeChannel","displayChannels","length","map","name","opacity","componentDidMount","componentWillUnmount","render"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport firebase from \"../../firebase\";\nimport { connect } from \"react-redux\";\nimport { setCurrentChannel, setPrivateChannel } from \"../../actions\";\nimport { Menu, Icon } from \"semantic-ui-react\";\n\nclass Starred extends React.Component {\n  state = {\n    user: this.props.currentUser,\n    usersRef: firebase.database().ref(\"users\"),\n    activeChannel: \"\",\n    starredChannels: []\n  };\n\n  componentDidMount() {\n    if (this.state.user) {\n      this.addListeners(this.state.user.uid);\n    }\n  }\n\n  componentWillUnmount() {\n    this.removeListener();\n  }\n\n  removeListener = () => {\n    this.state.usersRef.child(`${this.state.user.uid}/starred`).off();\n  };\n\n  addListeners = userId => {\n    this.state.usersRef\n      .child(userId)\n      .child(\"starred\")\n      .on(\"child_added\", snap => {\n        const starredChannel = { id: snap.key, ...snap.val() };\n        this.setState({\n          starredChannels: [...this.state.starredChannels, starredChannel]\n        });\n      });\n\n    this.state.usersRef\n      .child(userId)\n      .child(\"starred\")\n      .on(\"child_removed\", snap => {\n        const channelToRemove = { id: snap.key, ...snap.val() };\n        const filteredChannels = this.state.starredChannels.filter(channel => {\n          return channel.id !== channelToRemove.id;\n        });\n        this.setState({ starredChannels: filteredChannels });\n      });\n  };\n\n  setActiveChannel = channel => {\n    this.setState({ activeChannel: channel.id });\n  };\n\n  changeChannel = channel => {\n    this.setActiveChannel(channel);\n    this.props.setCurrentChannel(channel);\n    this.props.setPrivateChannel(false);\n  };\n\n  displayChannels = starredChannels =>\n    starredChannels.length > 0 &&\n    starredChannels.map(channel => (\n      <Menu.Item\n        key={channel.id}\n        onClick={() => this.changeChannel(channel)}\n        name={channel.name}\n        style={{ opacity: 0.7 }}\n        active={channel.id === this.state.activeChannel}\n      >\n        # {channel.name}\n      </Menu.Item>\n    ));\n\n  render() {\n    const { starredChannels } = this.state;\n\n    return (\n      <Menu.Menu className=\"menu\">\n        <Menu.Item>\n          <span>\n            <Icon name=\"star\" /> STARRED\n          </span>{\" \"}\n          ({starredChannels.length})\n        </Menu.Item>\n        {this.displayChannels(starredChannels)}\n      </Menu.Menu>\n    );\n  }\n}\n\nexport default connect(\n  null,\n  { setCurrentChannel, setPrivateChannel }\n)(Starred);\n"]},"metadata":{},"sourceType":"module"}